{% extends "auctions/layout.html" %}

{% block body %}
 <h2>Listing: {{ listing.title }}</h2>

 <div>
  <img src="{{ listing.image_url|default_if_none:'No_Image_Available.jpg'}}" alt="{{ listing.title }}">
 </div>


 <div>
  {{ listing.description }}
 </div>


 <div>
  <h3>${{ current_bid.amount|default_if_none:'No price available' }}</h3>
 </div>

 <div>
  {% if user.is_authenticated %}
    <form method="POST">
      {% csrf_token %}
      {% if user in watchers %}
        <input type="submit" value="Unwatch" name="unwatch">
      {% else %}
        <input type="submit" value="Watch" name = "watch">
      {% endif %}
    </form>
    {% if user == current_bid.user %}
      {{ number_of_bids }} bid(s) so far.  Your bid is the current bid.
    {% else %}
      {{ number_of_bids }} bid(s) so far.
    {% endif %}
    <form method="POST">
      {% csrf_token %}
      {{ bid_form }}
      <input type="submit" value="Place Bid" name="bid">
    </form>


  {% else %}
    {{ number_of_bids }} bid(s) so far.
  {% endif %}
 </div>

 <div>
  <h4>Details:</h4>
  <ul>
    <li>Listed by: {{ listing.user }}</li>
    <li>Category:<a href="{% url 'category' category.id %}"> {{ listing.category|default_if_none:'No Category'}}</a></li>
  </ul>
  <h4>Watchers:</h4>
  <ul>
    {% for user in watchers %}
    <li>{{ user.username}}</li>
    {% empty %}
    <li>No watchers.</li>
    {% endfor %}
  </ul>
 </div>

{% endblock %}

